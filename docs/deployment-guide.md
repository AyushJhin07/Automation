# Deployment Guide

- Feature flags
  - GENERIC_EXECUTOR_ENABLED: set true in non-prod to exercise connectors via JSON definitions.
- Environment
  - Configure OAuth client IDs/secrets in deployment environment; never commit .env.
  - Prefer managed secrets: set `SECRET_MANAGER_PROVIDER=aws` and populate AWS Secrets Manager as described in [operations/secret-management](./operations/secret-management.md).
  - Ensure DATABASE_URL is set for persistence.
- Rate limits
  - See GET /api/status/rate-limits for derived vendor limits; adjust reverse proxy if needed.
- Health checks
  - GET /api/health/ready → readiness for registry/OAuth/DB configuration.
  - GET /api/health/features → feature flags.
- Logs & Security
  - Secrets redacted server-side; avoid printing credentials in app logs.
- Rollout
  - Flip connectors to Stable by registering API clients in ConnectorRegistry.
- Process topology
  - Run the web API/UI: `NODE_ENV=production node dist/index.js` (or `tsx server/index.ts` during development).
  - Run at least one execution worker: `NODE_ENV=production tsx server/workers/execution.ts` (scale horizontally for more throughput).
  - A root-level `Procfile` defines the production process manifest (`web`, `worker`, `scheduler`, `timers`, `encryption-rotation`) so platforms like Heroku, Render, or PM2 can auto-discover the correct bundles (`dist/index.js`, `dist/workers/execution.js`, `dist/workers/scheduler.js`, `dist/workers/timerDispatcher.js`, `dist/workers/encryption-rotation.js`).
  - Use a process supervisor (systemd, PM2, etc.) to restart the web and worker processes and to forward `SIGTERM` for graceful shutdowns.
  - Both processes require the same environment (DATABASE_URL, API keys). Workers will drain in-flight jobs before exiting.
