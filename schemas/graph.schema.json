{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://apps-script-studio.com/schemas/graph.schema.json",
  "title": "NodeGraph",
  "description": "A directed acyclic graph representing a Google Apps Script automation workflow",
  "type": "object",
  "required": [
    "id",
    "name",
    "nodes",
    "edges",
    "metadata"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "description": "Unique identifier for the graph"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Human-readable name for the automation"
    },
    "description": {
      "type": "string",
      "maxLength": 500,
      "description": "Optional description of what this automation does"
    },
    "nodes": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/Node"
      }
    },
    "edges": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Edge"
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        },
        "author": {
          "type": "string"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "version",
        "createdAt"
      ]
    }
  },
  "definitions": {
    "Node": {
      "type": "object",
      "required": [
        "id",
        "type",
        "position"
      ],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_-]+$"
        },
        "type": {
          "type": "string",
          "enum": [
            "action.adp.create_employee",
            "action.adp.get_payroll_report",
            "action.adp.run_payroll",
            "action.adp.update_employee",
            "action.airtable-enhanced.bulk_upsert",
            "action.airtable-enhanced.create_record",
            "action.airtable-enhanced.delete_record",
            "action.airtable-enhanced.find_records",
            "action.airtable-enhanced.update_record",
            "action.airtable-enhanced.upsert_record",
            "action.airtable.create_record",
            "action.airtable.delete_record",
            "action.airtable.list_records",
            "action.airtable.update_record",
            "action.asana-enhanced.add_comment",
            "action.asana-enhanced.add_subtask",
            "action.asana-enhanced.add_tag",
            "action.asana-enhanced.assign_task",
            "action.asana-enhanced.create_section",
            "action.asana-enhanced.create_task",
            "action.asana-enhanced.move_task",
            "action.asana-enhanced.set_due_date",
            "action.asana-enhanced.update_task",
            "action.bamboohr.approve_time_off",
            "action.bamboohr.create_employee",
            "action.bamboohr.create_time_off_request",
            "action.bamboohr.terminate_employee",
            "action.bamboohr.update_employee",
            "action.dropbox.create_folder",
            "action.dropbox.download_file",
            "action.dropbox.list_files",
            "action.dropbox.share_file",
            "action.dropbox.upload_file",
            "action.excel-online.add_row",
            "action.excel-online.create_table",
            "action.excel-online.get_range",
            "action.excel-online.update_row",
            "action.github-enhanced.add_label",
            "action.github-enhanced.comment_issue",
            "action.github-enhanced.create_issue",
            "action.github-enhanced.create_release",
            "action.github-enhanced.dispatch_workflow",
            "action.github.add_comment",
            "action.github.create_issue",
            "action.github.create_pull_request",
            "action.gmail-enhanced.add_label",
            "action.gmail-enhanced.batch_modify",
            "action.gmail-enhanced.create_draft",
            "action.gmail-enhanced.forward",
            "action.gmail-enhanced.mark_read",
            "action.gmail-enhanced.mark_unread",
            "action.gmail-enhanced.remove_label",
            "action.gmail-enhanced.reply",
            "action.gmail-enhanced.send",
            "action.gmail-enhanced.send_draft",
            "action.gmail.add_label",
            "action.gmail.archive_email",
            "action.gmail.batch_modify",
            "action.gmail.create_draft",
            "action.gmail.create_label",
            "action.gmail.delete_email",
            "action.gmail.forward_email",
            "action.gmail.get_profile",
            "action.gmail.mark_as_read",
            "action.gmail.mark_as_unread",
            "action.gmail.modify_labels_batch",
            "action.gmail.remove_label",
            "action.gmail.reply_to_email",
            "action.gmail.search_emails",
            "action.gmail.send_draft",
            "action.gmail.send_email",
            "action.gmail.stop_watch",
            "action.gmail.watch_inbox",
            "action.google-admin.add_member_to_group",
            "action.google-admin.create_group",
            "action.google-admin.create_user",
            "action.google-admin.delete_user",
            "action.google-admin.list_groups",
            "action.google-admin.list_users",
            "action.google-admin.remove_member_from_group",
            "action.google-admin.suspend_user",
            "action.google-admin.update_user",
            "action.google-calendar.add_attendees",
            "action.google-calendar.create_event",
            "action.google-calendar.delete_event",
            "action.google-calendar.find_events",
            "action.google-calendar.move_event",
            "action.google-calendar.remove_attendee",
            "action.google-calendar.set_conference_meet",
            "action.google-calendar.update_event",
            "action.google-chat.create_space",
            "action.google-chat.delete_message",
            "action.google-chat.post_message",
            "action.google-chat.reply_thread",
            "action.google-chat.update_message",
            "action.google-contacts.create_contact",
            "action.google-contacts.delete_contact",
            "action.google-contacts.search",
            "action.google-contacts.update_contact",
            "action.google-docs.add_heading",
            "action.google-docs.add_image_from_url",
            "action.google-docs.append_text",
            "action.google-docs.create_document",
            "action.google-docs.duplicate",
            "action.google-docs.export_pdf",
            "action.google-docs.insert_table",
            "action.google-docs.replace_text",
            "action.google-docs.share_document",
            "action.google-drive.copy_file",
            "action.google-drive.create_file",
            "action.google-drive.create_folder",
            "action.google-drive.delete_file",
            "action.google-drive.export_pdf",
            "action.google-drive.find_files",
            "action.google-drive.list_files",
            "action.google-drive.move_file",
            "action.google-drive.set_permissions",
            "action.google-drive.share_file",
            "action.google-drive.upload_base64",
            "action.google-drive.watch_changes",
            "action.google-forms.add_question",
            "action.google-forms.create_form",
            "action.google-forms.export_to_sheet",
            "action.google-forms.get_responses",
            "action.google-forms.update_question",
            "action.google-meet.add_participant",
            "action.google-meet.create_link",
            "action.google-meet.end_meeting",
            "action.google-meet.get_participants",
            "action.google-meet.get_recording",
            "action.google-sheets-enhanced.append_row",
            "action.google-sheets-enhanced.append_rows_bulk",
            "action.google-sheets-enhanced.clear_range",
            "action.google-sheets-enhanced.create_sheet",
            "action.google-sheets-enhanced.delete_row",
            "action.google-sheets-enhanced.find_replace",
            "action.google-sheets-enhanced.get_range",
            "action.google-sheets-enhanced.update_row",
            "action.google-slides.add_slide",
            "action.google-slides.create_presentation",
            "action.google-slides.duplicate_slide",
            "action.google-slides.export_pdf",
            "action.google-slides.insert_image",
            "action.google-slides.insert_textbox",
            "action.google-slides.share_presentation",
            "action.google-slides.update_text",
            "action.greenhouse.add_note",
            "action.greenhouse.advance_stage",
            "action.greenhouse.create_candidate",
            "action.greenhouse.schedule_interview",
            "action.greenhouse.update_candidate",
            "action.http.request",
            "action.hubspot.create_company",
            "action.hubspot.create_contact",
            "action.hubspot.create_deal",
            "action.hubspot.create_task",
            "action.hubspot.create_ticket",
            "action.hubspot.delete_company",
            "action.hubspot.delete_contact",
            "action.hubspot.delete_deal",
            "action.hubspot.get_contact",
            "action.hubspot.search_contacts",
            "action.hubspot.send_email",
            "action.hubspot.update_company",
            "action.hubspot.update_contact",
            "action.hubspot.update_deal",
            "action.jira.add_attachment",
            "action.jira.add_comment",
            "action.jira.add_label",
            "action.jira.add_watcher",
            "action.jira.add_worklog",
            "action.jira.assign_issue",
            "action.jira.create_issue",
            "action.jira.create_project",
            "action.jira.create_subtask",
            "action.jira.link_issues",
            "action.jira.search_issues",
            "action.jira.transition_issue",
            "action.jira.update_issue",
            "action.mailchimp.add_subscriber",
            "action.mailchimp.create_campaign",
            "action.mailchimp.send_campaign",
            "action.mailchimp.update_subscriber",
            "action.notion-enhanced.append_block",
            "action.notion-enhanced.archive_page",
            "action.notion-enhanced.create_database",
            "action.notion-enhanced.invite_user",
            "action.notion-enhanced.query_database",
            "action.notion-enhanced.update_database",
            "action.notion-enhanced.update_page",
            "action.notion.create_database_entry",
            "action.notion.create_page",
            "action.notion.query_database",
            "action.notion.update_page",
            "action.okta.assign_group",
            "action.okta.create_user",
            "action.okta.deactivate_user",
            "action.okta.reset_password",
            "action.okta.update_user",
            "action.onedrive.download_file",
            "action.onedrive.move_file",
            "action.onedrive.share_link",
            "action.onedrive.upload_file",
            "action.powerbi.add_rows",
            "action.powerbi.query_dataset",
            "action.powerbi.trigger_refresh",
            "action.salesforce.create_lead",
            "action.salesforce.create_opportunity",
            "action.salesforce.create_task",
            "action.salesforce.update_contact",
            "action.sharepoint.create_file",
            "action.sharepoint.create_list_item",
            "action.sharepoint.get_file",
            "action.sharepoint.share_link",
            "action.sharepoint.update_list_item",
            "action.sheets.append_row",
            "action.shopify.add_product_to_collection",
            "action.shopify.archive_product",
            "action.shopify.cancel_order",
            "action.shopify.complete_draft_order",
            "action.shopify.create_collection",
            "action.shopify.create_customer",
            "action.shopify.create_discount_code",
            "action.shopify.create_fulfillment_service",
            "action.shopify.create_order",
            "action.shopify.create_price_rule",
            "action.shopify.create_product",
            "action.shopify.delete_product",
            "action.shopify.fulfill_order",
            "action.shopify.get_products",
            "action.shopify.refund_order",
            "action.shopify.remove_product_from_collection",
            "action.shopify.search_customers",
            "action.shopify.unarchive_product",
            "action.shopify.update_customer",
            "action.shopify.update_inventory",
            "action.shopify.update_order",
            "action.shopify.update_product",
            "action.slack-enhanced.add_reaction",
            "action.slack-enhanced.delete_message",
            "action.slack-enhanced.invite_user",
            "action.slack-enhanced.kick_user",
            "action.slack-enhanced.post_message",
            "action.slack-enhanced.remove_reaction",
            "action.slack-enhanced.reply_in_thread",
            "action.slack-enhanced.schedule_message",
            "action.slack-enhanced.set_purpose",
            "action.slack-enhanced.set_topic",
            "action.slack-enhanced.update_message",
            "action.slack-enhanced.upload_file",
            "action.slack.add_reaction",
            "action.slack.archive_channel",
            "action.slack.create_channel",
            "action.slack.delete_message",
            "action.slack.list_channels",
            "action.slack.list_users",
            "action.slack.pin_message",
            "action.slack.remove_reaction",
            "action.slack.reply_in_thread",
            "action.slack.schedule_message",
            "action.slack.send_message",
            "action.slack.set_status",
            "action.slack.unpin_message",
            "action.slack.update_message",
            "action.slack.upload_file",
            "action.stripe.create_customer",
            "action.stripe.create_payment_intent",
            "action.stripe.create_refund",
            "action.stripe.create_subscription",
            "action.successfactors.create_employee",
            "action.successfactors.list_employees",
            "action.successfactors.terminate_employee",
            "action.successfactors.update_employee",
            "action.twilio.make_call",
            "action.twilio.send_sms",
            "action.twilio.send_whatsapp",
            "action.workday.create_position",
            "action.workday.create_worker",
            "action.workday.terminate_worker",
            "action.workday.update_position",
            "action.workday.update_worker",
            "trigger.adp.employee_added",
            "trigger.adp.payroll_completed",
            "trigger.airtable-enhanced.record_created",
            "trigger.airtable-enhanced.record_deleted",
            "trigger.airtable-enhanced.record_updated",
            "trigger.airtable.record_created",
            "trigger.airtable.record_updated",
            "trigger.asana-enhanced.comment_added",
            "trigger.asana-enhanced.task_completed",
            "trigger.asana-enhanced.task_created",
            "trigger.asana-enhanced.task_updated",
            "trigger.bamboohr.employee_added",
            "trigger.bamboohr.time_off_requested",
            "trigger.dropbox.file_modified",
            "trigger.dropbox.file_uploaded",
            "trigger.excel-online.row_added",
            "trigger.excel-online.row_updated",
            "trigger.github-enhanced.issue_commented",
            "trigger.github-enhanced.issue_opened",
            "trigger.github-enhanced.pull_request_opened",
            "trigger.github-enhanced.release_published",
            "trigger.github.issue_opened",
            "trigger.github.pull_request_opened",
            "trigger.gmail-enhanced.attachment_received",
            "trigger.gmail-enhanced.label_added",
            "trigger.gmail-enhanced.new_email",
            "trigger.gmail-enhanced.thread_updated",
            "trigger.gmail.attachment_received",
            "trigger.gmail.email_starred",
            "trigger.gmail.label_added",
            "trigger.gmail.new_email_received",
            "trigger.gmail.new_email_with_query",
            "trigger.gmail.thread_updated",
            "trigger.google-admin.group_created",
            "trigger.google-admin.group_member_added",
            "trigger.google-admin.user_created",
            "trigger.google-admin.user_updated",
            "trigger.google-calendar.event_created",
            "trigger.google-calendar.event_deleted",
            "trigger.google-calendar.event_starting_soon",
            "trigger.google-calendar.event_updated",
            "trigger.google-chat.member_joined",
            "trigger.google-chat.message_posted",
            "trigger.google-chat.space_created",
            "trigger.google-contacts.contact_added",
            "trigger.google-contacts.contact_updated",
            "trigger.google-docs.document_created",
            "trigger.google-docs.document_updated",
            "trigger.google-drive.file_created",
            "trigger.google-drive.file_moved",
            "trigger.google-drive.file_shared",
            "trigger.google-drive.file_trashed",
            "trigger.google-drive.file_updated",
            "trigger.google-drive.folder_created",
            "trigger.google-forms.form_updated",
            "trigger.google-forms.response_received",
            "trigger.google-meet.meeting_created",
            "trigger.google-meet.meeting_started",
            "trigger.google-meet.recording_ready",
            "trigger.google-sheets-enhanced.new_row",
            "trigger.google-sheets-enhanced.row_updated",
            "trigger.google-sheets-enhanced.sheet_added",
            "trigger.google-slides.presentation_created",
            "trigger.google-slides.presentation_updated",
            "trigger.google-slides.slide_added",
            "trigger.greenhouse.application_updated",
            "trigger.greenhouse.candidate_created",
            "trigger.hubspot.company_created",
            "trigger.hubspot.company_updated",
            "trigger.hubspot.contact_updated",
            "trigger.hubspot.deal_created",
            "trigger.hubspot.deal_stage_changed",
            "trigger.hubspot.form_submission",
            "trigger.hubspot.new_contact",
            "trigger.hubspot.new_deal",
            "trigger.hubspot.ticket_created",
            "trigger.hubspot.ticket_updated",
            "trigger.jira.comment_added",
            "trigger.jira.issue_commented",
            "trigger.jira.issue_created",
            "trigger.jira.issue_deleted",
            "trigger.jira.issue_transitioned",
            "trigger.jira.issue_updated",
            "trigger.jira.sprint_started",
            "trigger.mailchimp.campaign_sent",
            "trigger.mailchimp.subscriber_added",
            "trigger.notion-enhanced.comment_added",
            "trigger.notion-enhanced.page_updated",
            "trigger.notion.database_entry_created",
            "trigger.notion.page_created",
            "trigger.okta.group_assigned",
            "trigger.okta.user_created",
            "trigger.okta.user_suspended",
            "trigger.onedrive.file_created",
            "trigger.onedrive.file_updated",
            "trigger.powerbi.dataset_refresh_completed",
            "trigger.salesforce.lead_created",
            "trigger.salesforce.opportunity_closed",
            "trigger.sharepoint.file_added",
            "trigger.sharepoint.file_updated",
            "trigger.sharepoint.list_item_added",
            "trigger.shopify.customer_created",
            "trigger.shopify.inventory_low",
            "trigger.shopify.order_cancelled",
            "trigger.shopify.order_created",
            "trigger.shopify.order_fulfilled",
            "trigger.shopify.order_paid",
            "trigger.shopify.product_created",
            "trigger.shopify.product_updated",
            "trigger.shopify.refund_created",
            "trigger.slack-enhanced.channel_archived",
            "trigger.slack-enhanced.channel_created",
            "trigger.slack-enhanced.channel_unarchived",
            "trigger.slack-enhanced.file_shared",
            "trigger.slack-enhanced.message_edited",
            "trigger.slack-enhanced.message_posted",
            "trigger.slack-enhanced.reaction_added",
            "trigger.slack-enhanced.reaction_removed",
            "trigger.slack-enhanced.user_joined",
            "trigger.slack-enhanced.user_left",
            "trigger.slack.channel_archived",
            "trigger.slack.file_uploaded",
            "trigger.slack.message_edited",
            "trigger.slack.new_channel",
            "trigger.slack.new_message",
            "trigger.slack.reaction_removed",
            "trigger.slack.user_joined",
            "trigger.slack.user_left",
            "trigger.stripe.payment_succeeded",
            "trigger.stripe.subscription_created",
            "trigger.successfactors.employee_created",
            "trigger.successfactors.employee_updated",
            "trigger.time.cron",
            "trigger.twilio.call_completed",
            "trigger.twilio.message_received",
            "trigger.webhook.inbound",
            "trigger.workday.time_off_requested",
            "trigger.workday.worker_hired",
            "trigger.workday.worker_terminated"
          ]
        },
        "position": {
          "type": "object",
          "required": [
            "x",
            "y"
          ],
          "properties": {
            "x": {
              "type": "number"
            },
            "y": {
              "type": "number"
            }
          }
        },
        "data": {
          "type": "object",
          "description": "Node-specific configuration data"
        },
        "label": {
          "type": "string",
          "maxLength": 50
        }
      }
    },
    "Edge": {
      "type": "object",
      "required": [
        "id",
        "source",
        "target"
      ],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_-]+$"
        },
        "source": {
          "type": "string",
          "description": "Source node ID"
        },
        "target": {
          "type": "string",
          "description": "Target node ID"
        },
        "sourceHandle": {
          "type": "string",
          "description": "Optional source handle ID"
        },
        "targetHandle": {
          "type": "string",
          "description": "Optional target handle ID"
        },
        "condition": {
          "type": "object",
          "description": "Optional condition for conditional edges"
        }
      }
    }
  }
}