{
  "id": "dropbox",
  "name": "Dropbox",
  "description": "Automate file workflows with Dropbox cloud storage",
  "category": "File Storage",
  "icon": "dropbox",
  "color": "#0061FF",
  "authentication": {
    "type": "oauth2",
    "config": {
      "authUrl": "https://www.dropbox.com/oauth2/authorize",
      "tokenUrl": "https://api.dropboxapi.com/oauth2/token",
      "scopes": [
        "files.content.write",
        "files.content.read",
        "files.metadata.read"
      ]
    }
  },
  "baseUrl": "https://api.dropboxapi.com/2",
  "testConnection": {
    "endpoint": "/users/get_current_account",
    "method": "POST"
  },
  "actions": [
    {
      "id": "list_folder",
      "name": "List Folder",
      "description": "List the contents of a Dropbox folder",
      "endpoint": "/files/list_folder",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Path of the folder to list",
            "default": ""
          },
          "recursive": {
            "type": "boolean",
            "description": "Whether to list folders recursively",
            "default": false
          },
          "include_deleted": {
            "type": "boolean",
            "description": "Include deleted items",
            "default": false
          },
          "limit": {
            "type": "number",
            "description": "Maximum number of entries to return",
            "default": 25,
            "minimum": 1,
            "maximum": 2000
          }
        },
        "required": [],
        "additionalProperties": false
      }
    },
    {
      "id": "create_folder",
      "name": "Create Folder",
      "description": "Create a new folder",
      "endpoint": "/files/create_folder_v2",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Folder path to create"
          },
          "autorename": {
            "type": "boolean",
            "description": "Automatically rename if the folder exists",
            "default": false
          }
        },
        "required": ["path"],
        "additionalProperties": false
      }
    },
    {
      "id": "delete",
      "name": "Delete File or Folder",
      "description": "Delete a file or folder",
      "endpoint": "/files/delete_v2",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Path of the item to delete"
          }
        },
        "required": ["path"],
        "additionalProperties": false
      }
    },
    {
      "id": "move",
      "name": "Move File or Folder",
      "description": "Move a file or folder to a different location",
      "endpoint": "/files/move_v2",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "from_path": {
            "type": "string",
            "description": "Source path"
          },
          "to_path": {
            "type": "string",
            "description": "Destination path"
          },
          "autorename": {
            "type": "boolean",
            "description": "Automatically rename if destination exists",
            "default": false
          }
        },
        "required": ["from_path", "to_path"],
        "additionalProperties": false
      }
    },
    {
      "id": "copy",
      "name": "Copy File or Folder",
      "description": "Copy a file or folder",
      "endpoint": "/files/copy_v2",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "from_path": {
            "type": "string",
            "description": "Source path"
          },
          "to_path": {
            "type": "string",
            "description": "Destination path"
          },
          "autorename": {
            "type": "boolean",
            "description": "Automatically rename if destination exists",
            "default": false
          }
        },
        "required": ["from_path", "to_path"],
        "additionalProperties": false
      }
    },
    {
      "id": "get_metadata",
      "name": "Get Metadata",
      "description": "Retrieve metadata for a file or folder",
      "endpoint": "/files/get_metadata",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Path of the item"
          },
          "include_media_info": {
            "type": "boolean",
            "description": "Include media information",
            "default": false
          },
          "include_deleted": {
            "type": "boolean",
            "description": "Include deleted files",
            "default": false
          }
        },
        "required": ["path"],
        "additionalProperties": false
      }
    },
    {
      "id": "search",
      "name": "Search",
      "description": "Search for files and folders",
      "endpoint": "/files/search_v2",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Search query"
          },
          "max_results": {
            "type": "number",
            "description": "Maximum number of results",
            "default": 25,
            "minimum": 1,
            "maximum": 1000
          },
          "start": {
            "type": "number",
            "description": "Offset for paginated results",
            "default": 0
          }
        },
        "required": ["query"],
        "additionalProperties": false
      }
    },
    {
      "id": "create_shared_link",
      "name": "Create Shared Link",
      "description": "Generate a shared link for a file or folder",
      "endpoint": "/sharing/create_shared_link_with_settings",
      "method": "POST",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Path to share"
          },
          "requested_visibility": {
            "type": "string",
            "enum": ["public", "team_only", "password"],
            "description": "Visibility for the shared link"
          }
        },
        "required": ["path"],
        "additionalProperties": false
      }
    }
  ],
  "triggers": [
    {
      "id": "file_uploaded",
      "name": "File Uploaded",
      "description": "Triggered when a file is uploaded to a monitored path",
      "type": "polling",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Folder path to watch"
          }
        },
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "path_lower": { "type": "string" },
          "size": { "type": "number" }
        }
      }
    },
    {
      "id": "file_deleted",
      "name": "File Deleted",
      "description": "Triggered when a file is deleted",
      "type": "polling",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Folder path to watch"
          }
        },
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "path_lower": { "type": "string" },
          "name": { "type": "string" }
        }
      }
    }
  ]
}
