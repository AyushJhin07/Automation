{
  "id": "dynamics365",
  "name": "Microsoft Dynamics 365",
  "description": "Microsoft Dynamics 365 business applications suite",
  "category": "CRM",
  "icon": "dynamics365",
  "color": "#0078D4",
  "version": "1.0.0",
  "authentication": {
    "type": "oauth2",
    "config": {
      "authUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
      "tokenUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/token",
      "scopes": [
        "https://dynamics.microsoft.com/user_impersonation"
      ]
    }
  },
  "baseUrl": "https://{organization}.dynamics.com/api/data/v9.2",
  "actions": [
    {
      "id": "test_connection",
      "name": "Test Connection",
      "description": "Test the connection to Dynamics 365",
      "parameters": {
        "type": "object",
        "properties": {},
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "create_account",
      "name": "Create Account",
      "description": "Create a new account record",
      "parameters": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Account name"
          },
          "accountnumber": {
            "type": "string",
            "description": "Account number"
          },
          "telephone1": {
            "type": "string",
            "description": "Main phone number"
          },
          "emailaddress1": {
            "type": "string",
            "format": "email",
            "description": "Primary email address"
          },
          "websiteurl": {
            "type": "string",
            "format": "uri",
            "description": "Website URL"
          },
          "address1_line1": {
            "type": "string",
            "description": "Street address line 1"
          },
          "address1_city": {
            "type": "string",
            "description": "City"
          },
          "address1_stateorprovince": {
            "type": "string",
            "description": "State or province"
          },
          "address1_postalcode": {
            "type": "string",
            "description": "Postal code"
          },
          "address1_country": {
            "type": "string",
            "description": "Country"
          },
          "industrycode": {
            "type": "number",
            "description": "Industry code"
          },
          "revenue": {
            "type": "number",
            "description": "Annual revenue"
          },
          "numberofemployees": {
            "type": "number",
            "description": "Number of employees"
          },
          "description": {
            "type": "string",
            "description": "Account description"
          }
        },
        "required": [
          "name"
        ],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "get_account",
      "name": "Get Account",
      "description": "Retrieve an account record",
      "parameters": {
        "type": "object",
        "properties": {
          "accountid": {
            "type": "string",
            "description": "Account ID"
          },
          "$select": {
            "type": "string",
            "description": "Fields to select"
          },
          "$expand": {
            "type": "string",
            "description": "Related entities to expand"
          }
        },
        "required": [
          "accountid"
        ],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "update_account",
      "name": "Update Account",
      "description": "Update an account record",
      "parameters": {
        "type": "object",
        "properties": {
          "accountid": {
            "type": "string",
            "description": "Account ID"
          },
          "name": {
            "type": "string",
            "description": "Account name"
          },
          "telephone1": {
            "type": "string",
            "description": "Main phone number"
          },
          "emailaddress1": {
            "type": "string",
            "format": "email",
            "description": "Primary email address"
          },
          "websiteurl": {
            "type": "string",
            "format": "uri",
            "description": "Website URL"
          },
          "revenue": {
            "type": "number",
            "description": "Annual revenue"
          },
          "numberofemployees": {
            "type": "number",
            "description": "Number of employees"
          },
          "description": {
            "type": "string",
            "description": "Account description"
          }
        },
        "required": [
          "accountid"
        ],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "list_accounts",
      "name": "List Accounts",
      "description": "List account records",
      "parameters": {
        "type": "object",
        "properties": {
          "$select": {
            "type": "string",
            "description": "Fields to select"
          },
          "$filter": {
            "type": "string",
            "description": "OData filter expression"
          },
          "$orderby": {
            "type": "string",
            "description": "Sort order"
          },
          "$top": {
            "type": "number",
            "minimum": 1,
            "maximum": 5000,
            "default": 50,
            "description": "Number of records to return"
          },
          "$skip": {
            "type": "number",
            "description": "Number of records to skip"
          },
          "$expand": {
            "type": "string",
            "description": "Related entities to expand"
          }
        },
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "create_contact",
      "name": "Create Contact",
      "description": "Create a new contact record",
      "parameters": {
        "type": "object",
        "properties": {
          "firstname": {
            "type": "string",
            "description": "First name"
          },
          "lastname": {
            "type": "string",
            "description": "Last name"
          },
          "emailaddress1": {
            "type": "string",
            "format": "email",
            "description": "Primary email address"
          },
          "telephone1": {
            "type": "string",
            "description": "Business phone"
          },
          "mobilephone": {
            "type": "string",
            "description": "Mobile phone"
          },
          "jobtitle": {
            "type": "string",
            "description": "Job title"
          },
          "parentcustomerid_account@odata.bind": {
            "type": "string",
            "description": "Associated account (use /accounts(accountid) format)"
          },
          "address1_line1": {
            "type": "string",
            "description": "Street address line 1"
          },
          "address1_city": {
            "type": "string",
            "description": "City"
          },
          "address1_stateorprovince": {
            "type": "string",
            "description": "State or province"
          },
          "address1_postalcode": {
            "type": "string",
            "description": "Postal code"
          },
          "address1_country": {
            "type": "string",
            "description": "Country"
          },
          "description": {
            "type": "string",
            "description": "Contact description"
          }
        },
        "required": [
          "lastname"
        ],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "create_lead",
      "name": "Create Lead",
      "description": "Create a new lead record",
      "parameters": {
        "type": "object",
        "properties": {
          "firstname": {
            "type": "string",
            "description": "First name"
          },
          "lastname": {
            "type": "string",
            "description": "Last name"
          },
          "subject": {
            "type": "string",
            "description": "Lead topic"
          },
          "emailaddress1": {
            "type": "string",
            "format": "email",
            "description": "Email address"
          },
          "telephone1": {
            "type": "string",
            "description": "Business phone"
          },
          "mobilephone": {
            "type": "string",
            "description": "Mobile phone"
          },
          "companyname": {
            "type": "string",
            "description": "Company name"
          },
          "jobtitle": {
            "type": "string",
            "description": "Job title"
          },
          "industrycode": {
            "type": "number",
            "description": "Industry code"
          },
          "revenue": {
            "type": "number",
            "description": "Annual revenue"
          },
          "numberofemployees": {
            "type": "number",
            "description": "Number of employees"
          },
          "leadqualitycode": {
            "type": "number",
            "description": "Lead quality code"
          },
          "leadsourcecode": {
            "type": "number",
            "description": "Lead source code"
          },
          "description": {
            "type": "string",
            "description": "Lead description"
          }
        },
        "required": [
          "lastname",
          "subject"
        ],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "create_opportunity",
      "name": "Create Opportunity",
      "description": "Create a new opportunity record",
      "parameters": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Opportunity name"
          },
          "estimatedvalue": {
            "type": "number",
            "description": "Estimated revenue"
          },
          "estimatedclosedate": {
            "type": "string",
            "format": "date",
            "description": "Estimated close date"
          },
          "closeprobability": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "Close probability percentage"
          },
          "parentaccountid@odata.bind": {
            "type": "string",
            "description": "Associated account (use /accounts(accountid) format)"
          },
          "parentcontactid@odata.bind": {
            "type": "string",
            "description": "Associated contact (use /contacts(contactid) format)"
          },
          "salesstage": {
            "type": "number",
            "description": "Sales stage code"
          },
          "stepname": {
            "type": "string",
            "description": "Current pipeline phase"
          },
          "description": {
            "type": "string",
            "description": "Opportunity description"
          }
        },
        "required": [
          "name"
        ],
        "additionalProperties": false
      },
      "outputSchema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the operation succeeded."
          }
        },
        "required": [
          "success"
        ],
        "additionalProperties": true
      },
      "sample": {
        "success": true
      }
    }
  ],
  "triggers": [
    {
      "id": "account_created",
      "name": "Account Created",
      "description": "Triggered when a new account is created",
      "type": "webhook",
      "parameters": {
        "type": "object",
        "properties": {
          "industrycode": {
            "type": "number",
            "description": "Filter by industry"
          }
        },
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "accountid": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "createdon": {
            "type": "string"
          }
        },
        "$schema": "http://json-schema.org/draft-07/schema#"
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "lead_created",
      "name": "Lead Created",
      "description": "Triggered when a new lead is created",
      "type": "webhook",
      "parameters": {
        "type": "object",
        "properties": {},
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "leadid": {
            "type": "string"
          },
          "subject": {
            "type": "string"
          },
          "fullname": {
            "type": "string"
          }
        },
        "$schema": "http://json-schema.org/draft-07/schema#"
      },
      "sample": {
        "success": true
      }
    },
    {
      "id": "opportunity_won",
      "name": "Opportunity Won",
      "description": "Triggered when an opportunity is won",
      "type": "webhook",
      "parameters": {
        "type": "object",
        "properties": {},
        "required": [],
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "opportunityid": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "actualvalue": {
            "type": "number"
          }
        },
        "$schema": "http://json-schema.org/draft-07/schema#"
      },
      "sample": {
        "success": true
      }
    }
  ],
  "testConnection": {
    "method": "GET",
    "endpoint": "/accounts?$top=1"
  },
  "release": {
    "semver": "1.0.0",
    "status": "stable",
    "isBeta": false,
    "betaStartedAt": null,
    "deprecationWindow": {
      "startDate": null,
      "sunsetDate": null
    }
  },
  "schemaVersion": "1.0"
}
