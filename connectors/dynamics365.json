{
  "id": "dynamics365",
  "name": "Microsoft Dynamics 365 (Sales)",
  "category": "CRM",
  "description": "Microsoft Dynamics 365 Sales CRM platform for customer relationship management",
  "version": "1.0.0",
  "authentication": {
    "type": "oauth2",
    "config": {
      "authUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
      "tokenUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/token",
      "scopes": ["https://{{org}}.crm.dynamics.com/.default"]
    }
  },
  "actions": [
    {
      "id": "create_account",
      "name": "Create Account",
      "description": "Create a new account in Dynamics 365",
      "parameters": {
        "name": {
          "type": "string",
          "required": true,
          "description": "Account name"
        },
        "telephone1": {
          "type": "string",
          "required": false,
          "description": "Primary phone number"
        },
        "emailaddress1": {
          "type": "string",
          "required": false,
          "description": "Primary email address"
        },
        "websiteurl": {
          "type": "string",
          "required": false,
          "description": "Website URL"
        },
        "address1_line1": {
          "type": "string",
          "required": false,
          "description": "Address line 1"
        },
        "address1_city": {
          "type": "string",
          "required": false,
          "description": "City"
        },
        "address1_stateorprovince": {
          "type": "string",
          "required": false,
          "description": "State or province"
        },
        "address1_postalcode": {
          "type": "string",
          "required": false,
          "description": "Postal code"
        }
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "update_account",
      "name": "Update Account",
      "description": "Update an existing account in Dynamics 365",
      "parameters": {
        "accountid": {
          "type": "string",
          "required": true,
          "description": "Account ID to update"
        },
        "name": {
          "type": "string",
          "required": false,
          "description": "Account name"
        },
        "telephone1": {
          "type": "string",
          "required": false,
          "description": "Primary phone number"
        },
        "emailaddress1": {
          "type": "string",
          "required": false,
          "description": "Primary email address"
        },
        "websiteurl": {
          "type": "string",
          "required": false,
          "description": "Website URL"
        }
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "create_contact",
      "name": "Create Contact",
      "description": "Create a new contact in Dynamics 365",
      "parameters": {
        "firstname": {
          "type": "string",
          "required": true,
          "description": "First name"
        },
        "lastname": {
          "type": "string",
          "required": true,
          "description": "Last name"
        },
        "emailaddress1": {
          "type": "string",
          "required": false,
          "description": "Primary email address"
        },
        "telephone1": {
          "type": "string",
          "required": false,
          "description": "Primary phone number"
        },
        "jobtitle": {
          "type": "string",
          "required": false,
          "description": "Job title"
        },
        "parentcustomerid": {
          "type": "string",
          "required": false,
          "description": "Associated account ID"
        }
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "create_lead",
      "name": "Create Lead",
      "description": "Create a new lead in Dynamics 365",
      "parameters": {
        "firstname": {
          "type": "string",
          "required": false,
          "description": "First name"
        },
        "lastname": {
          "type": "string",
          "required": true,
          "description": "Last name"
        },
        "subject": {
          "type": "string",
          "required": true,
          "description": "Lead subject/topic"
        },
        "emailaddress1": {
          "type": "string",
          "required": false,
          "description": "Primary email address"
        },
        "telephone1": {
          "type": "string",
          "required": false,
          "description": "Primary phone number"
        },
        "companyname": {
          "type": "string",
          "required": false,
          "description": "Company name"
        }
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "create_opportunity",
      "name": "Create Opportunity",
      "description": "Create a new opportunity in Dynamics 365",
      "parameters": {
        "name": {
          "type": "string",
          "required": true,
          "description": "Opportunity name"
        },
        "estimatedvalue": {
          "type": "number",
          "required": false,
          "description": "Estimated value"
        },
        "estimatedclosedate": {
          "type": "string",
          "required": false,
          "description": "Estimated close date (ISO format)"
        },
        "parentaccountid": {
          "type": "string",
          "required": false,
          "description": "Associated account ID"
        },
        "parentcontactid": {
          "type": "string",
          "required": false,
          "description": "Associated contact ID"
        }
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "add_activity_note",
      "name": "Add Activity Note",
      "description": "Add a note to a record in Dynamics 365",
      "parameters": {
        "subject": {
          "type": "string",
          "required": true,
          "description": "Note subject"
        },
        "notetext": {
          "type": "string",
          "required": true,
          "description": "Note content"
        },
        "objectid": {
          "type": "string",
          "required": true,
          "description": "ID of the record to attach note to"
        },
        "objecttypecode": {
          "type": "string",
          "required": true,
          "description": "Type of record (account, contact, lead, opportunity)"
        }
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    }
  ],
  "triggers": [
    {
      "id": "account_created",
      "name": "Account Created",
      "description": "Triggered when a new account is created",
      "parameters": {},
      "webhook": {
        "eventTypes": ["Create"],
        "entityTypes": ["account"]
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "contact_created",
      "name": "Contact Created", 
      "description": "Triggered when a new contact is created",
      "parameters": {},
      "webhook": {
        "eventTypes": ["Create"],
        "entityTypes": ["contact"]
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "lead_created",
      "name": "Lead Created",
      "description": "Triggered when a new lead is created",
      "parameters": {},
      "webhook": {
        "eventTypes": ["Create"],
        "entityTypes": ["lead"]
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    },
    {
      "id": "opportunity_updated",
      "name": "Opportunity Updated",
      "description": "Triggered when an opportunity is updated",
      "parameters": {},
      "webhook": {
        "eventTypes": ["Update"],
        "entityTypes": ["opportunity"]
      },
      "requiredScopes": ["https://{{org}}.crm.dynamics.com/.default"]
    }
  ]
}