// Complete 500+ Application Database for AI Workflow Builder
// Organized by popularity and business usage

export const COMPLETE_APP_LIST = {
  // ===== TOP 50 MOST POPULAR (Tier 1) =====
  tier1_essential: [
    // Google Workspace (10 apps)
    'Gmail', 'Google Sheets', 'Google Drive', 'Google Calendar', 'Google Docs', 
    'Google Forms', 'Google Slides', 'Google Meet', 'Google Chat', 'Google Analytics',
    
    // Microsoft Office 365 (10 apps)
    'Outlook', 'Excel Online', 'OneDrive', 'Microsoft Teams', 'Word Online', 
    'PowerPoint Online', 'SharePoint', 'OneNote', 'Planner', 'Power BI',
    
    // Communication (10 apps)
    'Slack', 'Zoom', 'Discord', 'WhatsApp Business', 'Telegram', 
    'Skype', 'WebEx', 'GoToMeeting', 'Rocket.Chat', 'Mattermost',
    
    // CRM & Sales (10 apps)
    'Salesforce', 'HubSpot', 'Pipedrive', 'Zoho CRM', 'Freshsales', 
    'Copper', 'Insightly', 'Close', 'ActiveCampaign', 'Keap',
    
    // Project Management (10 apps)
    'Asana', 'Trello', 'Monday.com', 'Jira', 'ClickUp', 
    'Basecamp', 'Wrike', 'Smartsheet', 'Airtable', 'Linear'
  ],

  // ===== BUSINESS CRITICAL (Tier 2) =====
  tier2_business: [
    // E-commerce (25 apps)
    'Shopify', 'WooCommerce', 'BigCommerce', 'Magento', 'Square', 'Amazon Seller', 'eBay',
    'Etsy', 'Walmart Marketplace', 'Facebook Shop', 'Instagram Shopping', 'TikTok Shop',
    'PrestaShop', 'OpenCart', 'Wix eCommerce', 'Squarespace Commerce', 'Volusion',
    'LightSpeed', 'Ecwid', 'Sellfy', 'Gumroad', 'Big Cartel', 'Shift4Shop', 'CS-Cart', 'nopCommerce',

    // Finance & Payments (25 apps)
    'Stripe', 'PayPal', 'QuickBooks', 'Xero', 'FreshBooks', 'Wave Accounting', 'Sage',
    'Zoho Books', 'Invoice Ninja', 'Receipt Bank', 'Expensify', 'Concur', 'Ramp',
    'Brex', 'Mercury', 'Wise', 'Revolut Business', 'Square Payments', 'Authorize.Net',
    'Adyen', 'Klarna', 'Afterpay', 'Affirm', 'Plaid', 'Yodlee',

    // Marketing & Advertising (25 apps)
    'Mailchimp', 'Constant Contact', 'SendGrid', 'Klaviyo', 'ConvertKit', 'AWeber',
    'GetResponse', 'Campaign Monitor', 'Drip', 'Facebook Ads', 'Google Ads', 'LinkedIn Ads',
    'Twitter Ads', 'Pinterest Ads', 'Snapchat Ads', 'TikTok Ads', 'YouTube Ads',
    'Bing Ads', 'Taboola', 'Outbrain', 'Criteo', 'AdRoll', 'Perfect Audience', 'Retargeter', 'Pardot',

    // HR & Recruiting (25 apps)
    'BambooHR', 'Workday', 'ADP', 'Paychex', 'Gusto', 'Greenhouse', 'Lever', 'JazzHR',
    'Indeed', 'LinkedIn Talent', 'ZipRecruiter', 'Glassdoor', 'AngelList', 'Hired',
    'Workable', 'SmartRecruiters', 'iCIMS', 'Taleo', 'SuccessFactors', 'Cornerstone OnDemand',
    'UltiPro', 'Namely', 'Zenefits', 'Rippling', 'Justworks'
  ],

  // ===== INDUSTRY SPECIFIC (Tier 3) =====
  tier3_industry: [
    // Real Estate (20 apps)
    'Zillow', 'Realtor.com', 'MLS', 'PropertyRadar', 'BiggerPockets', 'LoopNet',
    'CoStar', 'RentSpree', 'Apartments.com', 'Rent.com', 'Zumper', 'PadMapper',
    'Chime', 'Follow Up Boss', 'KvCORE', 'Wise Agent', 'Top Producer', 'BoomTown',
    'Realvolve', 'LionDesk',

    // Healthcare (20 apps)
    'Epic', 'Cerner', 'Allscripts', 'eClinicalWorks', 'NextGen', 'athenahealth',
    'Practice Fusion', 'DrChrono', 'SimplePractice', 'TherapyNotes', 'TheraNest',
    'WebPT', 'Kareo', 'AdvancedMD', 'Amazing Charts', 'CureMD', 'PrognoCIS',
    'Greenway Health', 'MEDITECH', 'CPSI',

    // Legal (20 apps)
    'Clio', 'MyCase', 'PracticePanther', 'CosmoLex', 'TimeSolv', 'LawPay',
    'LegalZoom', 'Rocket Lawyer', 'DocuSign', 'PandaDoc', 'HelloSign', 'Adobe Sign',
    'Contract Works', 'Ironclad', 'Concord', 'SpringCM', 'NetDocuments', 'iManage',
    'Relativity', 'Concordance',

    // Education (20 apps)
    'Canvas', 'Blackboard', 'Moodle', 'Google Classroom', 'Schoology', 'Edmodo',
    'Brightspace', 'PowerSchool', 'Infinite Campus', 'Skyward', 'Clever', 'ClassDojo',
    'Remind', 'Seesaw', 'Flipgrid', 'Kahoot', 'Quizlet', 'Padlet', 'Nearpod', 'Pear Deck'
  ],

  // ===== SPECIALIZED TOOLS (Tier 4) =====
  tier4_specialized: [
    // Design & Creative (30 apps)
    'Figma', 'Adobe Photoshop', 'Adobe Illustrator', 'Adobe InDesign', 'Adobe XD',
    'Sketch', 'InVision', 'Marvel', 'Principle', 'Framer', 'Canva', 'Crello',
    'PicMonkey', 'Snappa', 'Easil', 'RelayThat', 'Stencil', 'Pablo', 'Quotes Cover',
    'Adobe After Effects', 'Adobe Premiere Pro', 'Final Cut Pro', 'DaVinci Resolve',
    'Blender', 'Cinema 4D', 'Maya', 'SketchUp', 'AutoCAD', 'SolidWorks',

    // Analytics & BI (30 apps)
    'Google Analytics', 'Adobe Analytics', 'Mixpanel', 'Amplitude', 'Segment',
    'Hotjar', 'Crazy Egg', 'FullStory', 'LogRocket', 'Heap', 'Kissmetrics',
    'Chartio', 'Looker', 'Tableau', 'Power BI', 'Qlik Sense', 'Sisense',
    'Domo', 'Periscope Data', 'Mode Analytics', 'DataStudio', 'Metabase',
    'Apache Superset', 'Grafana', 'Kibana', 'Splunk', 'New Relic', 'Datadog',
    'AppDynamics', 'Dynatrace',

    // Video & Audio (30 apps)
    'YouTube', 'Vimeo', 'Wistia', 'Brightcove', 'JW Player', 'Vidyard',
    'Loom', 'Camtasia', 'ScreenFlow', 'OBS Studio', 'Streamlabs', 'Twitch',
    'Facebook Live', 'Instagram Live', 'LinkedIn Live', 'Periscope', 'Clubhouse',
    'Spotify', 'Apple Music', 'SoundCloud', 'Audible', 'Podcast.co', 'Anchor',
    'Buzzsprout', 'Libsyn', 'Podbean', 'Simplecast', 'Transistor', 'Castos', 'RedCircle',

    // Development & DevOps (40 apps)
    'GitHub', 'GitLab', 'Bitbucket', 'Azure DevOps', 'Jenkins', 'CircleCI',
    'Travis CI', 'GitHub Actions', 'GitLab CI', 'Bamboo', 'TeamCity', 'CodeShip',
    'Docker', 'Kubernetes', 'AWS', 'Azure', 'Google Cloud', 'Heroku', 'Netlify',
    'Vercel', 'DigitalOcean', 'Linode', 'Vultr', 'MongoDB Atlas', 'Firebase',
    'Supabase', 'PlanetScale', 'Railway', 'Render', 'Fly.io', 'Cloudflare',
    'DataDog', 'New Relic', 'Sentry', 'Rollbar', 'Bugsnag', 'LogRocket',
    'Postman', 'Insomnia', 'Swagger'
  ],

  // ===== EMERGING & NICHE (Tier 5) =====
  tier5_emerging: [
    // AI & Machine Learning (25 apps)
    'OpenAI', 'Anthropic Claude', 'Google Gemini', 'Hugging Face', 'Replicate',
    'RunPod', 'Together AI', 'Cohere', 'AI21 Labs', 'Stability AI', 'Midjourney',
    'DALL-E', 'Stable Diffusion', 'ChatGPT', 'GitHub Copilot', 'Tabnine',
    'Kite', 'Sourcery', 'DeepCode', 'Snyk', 'SonarQube', 'CodeClimate',
    'Codacy', 'Veracode', 'Checkmarx',

    // Blockchain & Crypto (15 apps)
    'Coinbase', 'Binance', 'Kraken', 'Ethereum', 'Polygon', 'Solana',
    'Avalanche', 'Chainlink', 'Uniswap', 'OpenSea', 'MetaMask', 'WalletConnect',
    'Moralis', 'Alchemy', 'Infura',

    // IoT & Hardware (15 apps)
    'Arduino', 'Raspberry Pi', 'Particle', 'Adafruit IO', 'ThingSpeak',
    'AWS IoT', 'Azure IoT', 'Google Cloud IoT', 'Samsung SmartThings',
    'Philips Hue', 'IFTTT', 'Zapier', 'Microsoft Flow', 'Node-RED', 'Home Assistant'
  ]
};

// Generate complete app database (500+ apps)
export function generateCompleteAppDatabase(): any[] {
  const allApps = [
    ...COMPLETE_APP_LIST.tier1_essential,
    ...COMPLETE_APP_LIST.tier2_business,
    ...COMPLETE_APP_LIST.tier3_industry,
    ...COMPLETE_APP_LIST.tier4_specialized,
    ...COMPLETE_APP_LIST.tier5_emerging
  ];

  return allApps.map((appName, index) => ({
    id: appName.toLowerCase().replace(/[^a-z0-9]/g, '_'),
    name: appName,
    category: getCategoryForApp(appName),
    description: `${appName} integration and automation`,
    icon: getIconForAppName(appName),
    color: getColorForAppName(appName),
    apiType: getApiTypeForApp(appName),
    authType: getAuthTypeForApp(appName),
    popularity: Math.max(1, 10 - Math.floor(index / 50)), // Decreasing popularity
    complexity: getComplexityForApp(appName),
    commonFunctions: getCommonFunctionsForApp(appName),
    triggers: getTriggersForApp(appName),
    actions: getActionsForApp(appName)
  }));
}

function getCategoryForApp(appName: string): string {
  const categoryMap: Record<string, string> = {
    // Google Workspace
    'Gmail': 'Email & Communication',
    'Google Sheets': 'Spreadsheets & Data',
    'Google Drive': 'Storage & Files',
    'Google Calendar': 'Calendar & Scheduling',
    'Google Docs': 'Document Management',
    'Google Forms': 'Form & Survey',
    'Google Slides': 'Presentation',
    'Google Meet': 'Video & Conferencing',
    'Google Chat': 'Communication',
    'Google Analytics': 'Analytics & Reporting',
    
    // Communication
    'Slack': 'Communication',
    'Microsoft Teams': 'Communication',
    'Zoom': 'Video & Conferencing',
    'Discord': 'Communication',
    'WhatsApp Business': 'Communication',
    'Telegram': 'Communication',
    
    // CRM
    'Salesforce': 'CRM & Sales',
    'HubSpot': 'CRM & Sales',
    'Pipedrive': 'CRM & Sales',
    'Zoho CRM': 'CRM & Sales',
    'Freshsales': 'CRM & Sales',
    'Copper': 'CRM & Sales',
    'Insightly': 'CRM & Sales',
    
    // Project Management
    'Asana': 'Project Management',
    'Trello': 'Project Management',
    'Monday.com': 'Project Management',
    'Jira': 'Project Management',
    'ClickUp': 'Project Management',
    'Basecamp': 'Project Management',
    'Wrike': 'Project Management',
    'Smartsheet': 'Project Management',
    'Airtable': 'Database & Spreadsheets',
    'Linear': 'Project Management',
    
    // E-commerce
    'Shopify': 'E-commerce',
    'WooCommerce': 'E-commerce',
    'BigCommerce': 'E-commerce',
    'Magento': 'E-commerce',
    'Square': 'E-commerce & POS',
    'Amazon Seller': 'E-commerce',
    'eBay': 'E-commerce',
    'Etsy': 'E-commerce',
    
    // Finance & Payments
    'Stripe': 'Finance & Payments',
    'PayPal': 'Finance & Payments',
    'QuickBooks': 'Accounting & Finance',
    'Xero': 'Accounting & Finance',
    'FreshBooks': 'Accounting & Finance',
    'Wave Accounting': 'Accounting & Finance',
    'Sage': 'Accounting & Finance',
    
    // Marketing
    'Mailchimp': 'Email Marketing',
    'Constant Contact': 'Email Marketing',
    'SendGrid': 'Email Marketing',
    'Klaviyo': 'Email Marketing',
    'Facebook Ads': 'Advertising',
    'Google Ads': 'Advertising',
    'LinkedIn Ads': 'Advertising',
    
    // Social Media
    'Facebook': 'Social Media',
    'Instagram': 'Social Media',
    'Twitter': 'Social Media',
    'LinkedIn': 'Social Media',
    'YouTube': 'Video & Social',
    'TikTok': 'Social Media',
    'Pinterest': 'Social Media',
    
    // Development
    'GitHub': 'Development',
    'GitLab': 'Development',
    'Bitbucket': 'Development',
    'Jenkins': 'Development & DevOps',
    'Docker': 'Development & DevOps',
    'AWS': 'Cloud & Infrastructure',
    'Azure': 'Cloud & Infrastructure',
    
    // Customer Support
    'Zendesk': 'Customer Support',
    'Freshdesk': 'Customer Support',
    'Intercom': 'Customer Support',
    'Help Scout': 'Customer Support',
    
    // HR & Recruiting
    'BambooHR': 'HR & Recruiting',
    'Workday': 'HR & Recruiting',
    'ADP': 'HR & Recruiting',
    'Greenhouse': 'HR & Recruiting',
    'Lever': 'HR & Recruiting',
    
    // Storage
    'Dropbox': 'Storage & Files',
    'OneDrive': 'Storage & Files',
    'Box': 'Storage & Files',
    'AWS S3': 'Storage & Files',
    
    // Design & Creative
    'Figma': 'Design & Creative',
    'Adobe Photoshop': 'Design & Creative',
    'Canva': 'Design & Creative',
    'Sketch': 'Design & Creative',
    
    // Analytics
    'Mixpanel': 'Analytics & Reporting',
    'Amplitude': 'Analytics & Reporting',
    'Tableau': 'Analytics & Reporting',
    'Power BI': 'Analytics & Reporting'
  };
  
  return categoryMap[appName] || 'Business Tools';
}

function getIconForAppName(appName: string): string {
  const iconMap: Record<string, string> = {
    'Gmail': 'Mail',
    'Google Sheets': 'Sheet',
    'Google Drive': 'FolderOpen',
    'Google Calendar': 'Calendar',
    'Slack': 'MessageSquare',
    'Salesforce': 'Cloud',
    'HubSpot': 'Heart',
    'Asana': 'CheckSquare',
    'Trello': 'Trello',
    'Shopify': 'ShoppingBag',
    'Stripe': 'CreditCard',
    'GitHub': 'Github'
  };
  
  return iconMap[appName] || 'Zap';
}

function getColorForAppName(appName: string): string {
  const colorMap: Record<string, string> = {
    'Gmail': '#EA4335',
    'Google Sheets': '#0F9D58',
    'Google Drive': '#4285F4',
    'Google Calendar': '#4285F4',
    'Slack': '#4A154B',
    'Salesforce': '#00A1E0',
    'HubSpot': '#FF7A59',
    'Asana': '#F06A6A',
    'Trello': '#0079BF',
    'Shopify': '#7AB55C',
    'Stripe': '#635BFF',
    'GitHub': '#181717'
  };
  
  return colorMap[appName] || '#6366f1';
}

function getApiTypeForApp(appName: string): string {
  if (appName.startsWith('Google')) return 'native';
  if (['Slack', 'GitHub', 'Salesforce', 'HubSpot'].includes(appName)) return 'rest';
  return 'webhook';
}

function getAuthTypeForApp(appName: string): string {
  if (appName.startsWith('Google')) return 'oauth2';
  if (['Stripe', 'GitHub'].includes(appName)) return 'bearer';
  if (['HubSpot', 'Mailchimp'].includes(appName)) return 'api_key';
  return 'oauth2';
}

function getComplexityForApp(appName: string): string {
  const complexApps = ['Salesforce', 'SAP', 'Oracle', 'Workday', 'Epic'];
  const simpleApps = ['Trello', 'Gmail', 'Google Sheets', 'Slack'];
  
  if (complexApps.includes(appName)) return 'Complex';
  if (simpleApps.includes(appName)) return 'Simple';
  return 'Medium';
}

// Import comprehensive function library
import { getComprehensiveAppFunctions, AppFunction } from './comprehensive-app-functions';

function getCommonFunctionsForApp(appName: string): any[] {
  // Use comprehensive function library
  const comprehensiveFunctions = getComprehensiveAppFunctions(appName);
  
  // Convert to legacy format for backward compatibility
  return comprehensiveFunctions.map(func => ({
    id: func.id,
    name: func.name,
    description: func.description,
    category: func.category,
    parameters: func.parameters,
    requiredScopes: func.requiredScopes,
    rateLimits: func.rateLimits,
    pricing: func.pricing
  }));
}

// New function to get comprehensive function details
export function getComprehensiveAppFunctionsDetailed(appName: string): AppFunction[] {
  return getComprehensiveAppFunctions(appName);
}

// Legacy function for backward compatibility
export function getAppFunctions(appName: string) {
  return getComprehensiveAppFunctions(appName);
}

function getTriggersForApp(appName: string): any[] {
  return [
    { id: 'new_item', name: 'New Item', description: `When new item is created in ${appName}`, webhookSupport: true },
    { id: 'updated_item', name: 'Updated Item', description: `When item is updated in ${appName}`, webhookSupport: true }
  ];
}

function getActionsForApp(appName: string): any[] {
  return [
    { id: 'create_item', name: 'Create Item', description: `Create item in ${appName}`, requiredFields: ['name'] },
    { id: 'update_item', name: 'Update Item', description: `Update item in ${appName}`, requiredFields: ['id'] }
  ];
}

// Export total count
export const TOTAL_SUPPORTED_APPS = 
  COMPLETE_APP_LIST.tier1_essential.length +
  COMPLETE_APP_LIST.tier2_business.length + 
  COMPLETE_APP_LIST.tier3_industry.length +
  COMPLETE_APP_LIST.tier4_specialized.length +
  COMPLETE_APP_LIST.tier5_emerging.length;

console.log(`Total Supported Applications: ${TOTAL_SUPPORTED_APPS}`);

// Enhanced app detection with specific keyword matching
export function detectAppsFromPrompt(prompt: string): any[] {
  const lowerPrompt = prompt.toLowerCase();
  const detectedApps: any[] = [];
  const allApps = generateCompleteAppDatabase();
  
  // Enhanced app detection with intent-based matching
  const appDetectionRules = [
    // Email automation rules
    { 
      keywords: ['auto reply', 'automatic reply', 'mail responder', 'email responder'], 
      appName: 'Gmail',
      singleApp: true, // Only Gmail needed for auto-reply
      intent: 'email_auto_reply'
    },
    { 
      keywords: ['track email', 'monitor email', 'email tracking'], 
      appName: 'Gmail',
      singleApp: false, // Might need Sheets for tracking
      intent: 'email_tracking'
    },
    
    // Direct app name matching
    { keywords: ['shopify'], appName: 'Shopify' },
    { keywords: ['stripe'], appName: 'Stripe' },
    { keywords: ['slack'], appName: 'Slack' },
    { keywords: ['salesforce'], appName: 'Salesforce' },
    { keywords: ['hubspot'], appName: 'HubSpot' },
    { keywords: ['asana'], appName: 'Asana' },
    { keywords: ['trello'], appName: 'Trello' },
    { keywords: ['gmail'], appName: 'Gmail' },
    { keywords: ['google sheets', 'sheets'], appName: 'Google Sheets' },
    { keywords: ['google calendar', 'calendar'], appName: 'Google Calendar' },
    { keywords: ['google drive', 'drive'], appName: 'Google Drive' },
    { keywords: ['microsoft teams', 'teams'], appName: 'Microsoft Teams' },
    { keywords: ['discord'], appName: 'Discord' },
    { keywords: ['zoom'], appName: 'Zoom' },
    { keywords: ['mailchimp'], appName: 'Mailchimp' },
    { keywords: ['github'], appName: 'GitHub' },
    { keywords: ['jira'], appName: 'Jira' },
    { keywords: ['monday.com', 'monday'], appName: 'Monday.com' }
  ];

  // Check for app matches with intent understanding
  appDetectionRules.forEach((rule) => {
    const hasMatch = rule.keywords.some(keyword => lowerPrompt.includes(keyword));
    if (hasMatch) {
      const app = allApps.find(a => a.name === rule.appName);
      if (app && !detectedApps.find(d => d.name === rule.appName)) {
        detectedApps.push(app);
        
        // If it's a single-app automation, don't add more apps
        if (rule.singleApp) {
          return detectedApps;
        }
      }
    }
  });

  // If no direct matches, use context-based detection
  if (detectedApps.length === 0) {
    // E-commerce context
    if (lowerPrompt.includes('order') || lowerPrompt.includes('product') || lowerPrompt.includes('store')) {
      const shopifyApp = allApps.find(app => app.name === 'Shopify');
      if (shopifyApp) detectedApps.push(shopifyApp);
    }
    
    // Payment context
    if (lowerPrompt.includes('payment') || lowerPrompt.includes('charge') || lowerPrompt.includes('billing')) {
      const stripeApp = allApps.find(app => app.name === 'Stripe');
      if (stripeApp) detectedApps.push(stripeApp);
    }
    
    // Communication context
    if (lowerPrompt.includes('notify') || lowerPrompt.includes('message') || lowerPrompt.includes('team')) {
      const slackApp = allApps.find(app => app.name === 'Slack');
      if (slackApp) detectedApps.push(slackApp);
    }
    
    // CRM context
    if (lowerPrompt.includes('lead') || lowerPrompt.includes('contact') || lowerPrompt.includes('crm')) {
      const salesforceApp = allApps.find(app => app.name === 'Salesforce');
      if (salesforceApp) detectedApps.push(salesforceApp);
    }
    
    // Project management context
    if (lowerPrompt.includes('task') || lowerPrompt.includes('project') || lowerPrompt.includes('assign')) {
      const asanaApp = allApps.find(app => app.name === 'Asana');
      if (asanaApp) detectedApps.push(asanaApp);
    }
    
    // Default fallbacks
    if (detectedApps.length === 0) {
      if (lowerPrompt.includes('email')) {
        const gmailApp = allApps.find(app => app.name === 'Gmail');
        if (gmailApp) detectedApps.push(gmailApp);
      }
      if (lowerPrompt.includes('spreadsheet') || lowerPrompt.includes('data')) {
        const sheetsApp = allApps.find(app => app.name === 'Google Sheets');
        if (sheetsApp) detectedApps.push(sheetsApp);
      }
    }
  }
  
  return detectedApps.filter(Boolean).slice(0, 6); // Limit to 6 apps max
}

export function getAppById(id: string): any | undefined {
  const allApps = generateCompleteAppDatabase();
  return allApps.find(app => app.id === id);
}