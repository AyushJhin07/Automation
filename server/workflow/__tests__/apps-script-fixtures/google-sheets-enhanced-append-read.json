{
  "id": "google-sheets-enhanced-append-read",
  "description": "Tier-0 workflow that appends and reads Google Sheets rows via the enhanced connector",
  "graph": {
    "id": "fixture-google-sheets-enhanced-append-read",
    "name": "Google Sheets Enhanced append and read",
    "nodes": [
      {
        "id": "append",
        "type": "action.google-sheets-enhanced",
        "app": "google-sheets-enhanced",
        "name": "Append automation result",
        "op": "action.google-sheets-enhanced:append_row",
        "params": {
          "spreadsheetId": "sheet-123",
          "sheet": "Automation Log",
          "values": ["{{stage}}", "{{result}}"]
        },
        "data": {
          "operation": "append_row",
          "config": {
            "spreadsheetId": "sheet-123",
            "sheet": "Automation Log",
            "values": ["{{stage}}", "{{result}}"]
          }
        }
      },
      {
        "id": "read",
        "type": "action.google-sheets-enhanced",
        "app": "google-sheets-enhanced",
        "name": "Read appended row",
        "op": "action.google-sheets-enhanced:get_values",
        "params": {
          "spreadsheetId": "sheet-123",
          "range": "Automation Log!5:5"
        },
        "data": {
          "operation": "get_values",
          "config": {
            "spreadsheetId": "sheet-123",
            "range": "Automation Log!5:5"
          }
        }
      }
    ],
    "edges": [
      { "id": "flow-append-read", "from": "append", "to": "read", "source": "append", "target": "read" }
    ]
  },
  "entry": {
    "context": {
      "stage": "Tier 0",
      "result": "Success"
    }
  },
  "secrets": {
    "GOOGLE_SHEETS_ACCESS_TOKEN": "ya29.test-sheets-token"
  },
  "http": [
    {
      "name": "sheets-enhanced-append",
      "request": {
        "url": "https://sheets.googleapis.com/v4/spreadsheets/sheet-123/values/Automation%20Log:append?valueInputOption=USER_ENTERED&insertDataOption=INSERT_ROWS&includeValuesInResponse=true",
        "method": "POST",
        "headers": {
          "authorization": "Bearer ya29.test-sheets-token",
          "content-type": "application/json",
          "accept": "application/json"
        },
        "payload": {
          "values": [
            [
              "Tier 0",
              "Success"
            ]
          ]
        }
      },
      "response": {
        "status": 200,
        "body": {
          "updates": {
            "spreadsheetId": "sheet-123",
            "updatedRange": "Automation Log!A5:B5",
            "updatedRows": 1,
            "updatedColumns": 2,
            "updatedData": {
              "range": "Automation Log!A5:B5",
              "values": [
                [
                  "Tier 0",
                  "Success"
                ]
              ]
            }
          }
        }
      }
    },
    {
      "name": "sheets-enhanced-get-values",
      "request": {
        "url": "https://sheets.googleapis.com/v4/spreadsheets/sheet-123/values/Automation%20Log!5%3A5?majorDimension=ROWS&valueRenderOption=FORMATTED_VALUE&dateTimeRenderOption=FORMATTED_STRING",
        "method": "GET",
        "headers": {
          "authorization": "Bearer ya29.test-sheets-token",
          "accept": "application/json"
        }
      },
      "response": {
        "status": 200,
        "body": {
          "range": "Automation Log!A5:B5",
          "majorDimension": "ROWS",
          "values": [
            [
              "Tier 0",
              "Success"
            ]
          ]
        }
      }
    }
  ],
  "expect": {
    "context": {
      "stage": "Tier 0",
      "result": "Success",
      "row": 5,
      "rowNumber": 5,
      "googleSheetsRowNumber": 5,
      "rowValues": ["Tier 0", "Success"],
      "googleSheetsRowValues": ["Tier 0", "Success"],
      "googleSheetsEnhancedLastAppend": {
        "success": true,
        "spreadsheetId": "sheet-123",
        "sheetName": "Automation Log",
        "range": "Automation Log",
        "updatedRange": "Automation Log!A5:B5",
        "updatedRows": 1,
        "updatedColumns": 2,
        "values": ["Tier 0", "Success"],
        "rowNumber": 5
      },
      "googleSheetsLastAppend": {
        "success": true,
        "spreadsheetId": "sheet-123",
        "sheetName": "Automation Log",
        "range": "Automation Log",
        "updatedRange": "Automation Log!A5:B5",
        "updatedRows": 1,
        "updatedColumns": 2,
        "values": ["Tier 0", "Success"],
        "rowNumber": 5
      },
      "googleSheetsEnhancedLastRead": {
        "spreadsheetId": "sheet-123",
        "range": "Automation Log!A5:B5",
        "majorDimension": "ROWS",
        "values": [
          [
            "Tier 0",
            "Success"
          ]
        ],
        "valueRenderOption": "FORMATTED_VALUE",
        "dateTimeRenderOption": "FORMATTED_STRING"
      },
      "googleSheetsLastRead": {
        "spreadsheetId": "sheet-123",
        "range": "Automation Log!A5:B5",
        "majorDimension": "ROWS",
        "values": [
          [
            "Tier 0",
            "Success"
          ]
        ],
        "valueRenderOption": "FORMATTED_VALUE",
        "dateTimeRenderOption": "FORMATTED_STRING"
      }
    },
    "httpCalls": [
      {
        "url": "https://sheets.googleapis.com/v4/spreadsheets/sheet-123/values/Automation%20Log:append?valueInputOption=USER_ENTERED&insertDataOption=INSERT_ROWS&includeValuesInResponse=true",
        "method": "POST"
      },
      {
        "url": "https://sheets.googleapis.com/v4/spreadsheets/sheet-123/values/Automation%20Log!5%3A5?majorDimension=ROWS&valueRenderOption=FORMATTED_VALUE&dateTimeRenderOption=FORMATTED_STRING",
        "method": "GET"
      }
    ]
  }
}
